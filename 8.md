###  A Risk Stratification Model for Lung Cancer Based on Gene Coexpression Network and Deep Learning (Article 8)

<center>Student Name: Zheyuan Zhou</center>

<center> Student ID: 117010423

##### Problem statement and motivations  


###### **problem statement**

This article focuses on the lung cancer, which has heteroeneous molecular features. This feature leads to diverse adjuvant treatment options and different prognosis. Therefore, risk stratification models for prediction of accurate prognosis is needed. According to literature review, the previous researchs on risk stratification model, usually using Cox regression, has following drawbacks:

- Focus on indiviual significant gene, which might lead to substantial problem of multiple statistical tesing.
- Cannot validate in independent samples of other studies.
- Lack of overlapping significant prognostic genes$^{[2]}$.

Hence, a better model is needed.

###### motivations

Start from the evidence: biological processes are derived from numerous interactions between many cellular components, the authors proposed a gene network analysis based on Deep Learning (DL). Two objectives are proposed logically: firstly, need to recognize the gene related to survive coexpression network modules; secondly, need to develop a deep learning model for risk stratication to promote the original model.

To develop a module, two processes are necessary: training the model and testing the model. And the intact work flow is roughly divided into four stages: firstly, obtain the training dataset by formulte gene coexpression network; secondly, training: extract the survial-related gene network modules by topological overlap and testing: apply validation to the selected modules using testing datasets; thirdly, select representative genes, which is a strategy to simplify the model; fourthly, apply deep learning idea CNN to training: construct risk stratification model and testing: according to the stasitic analysis of generated Netscore to validate the scoring system.



##### Highlights of the proposed method  

Some methods proposed by authors need to be approved.

- *Gene network analysis perspective*. From the whole picture, choosing an gene network analysis perspective is impressive, considering the gene regulation does form a network structure. Therefore, CNN chosed by authors is suitable, since it performs well in processing data with similar grid structure like time series data(one dimention) and image data(two dimention)$^{[1]}$.
- *Hierarchical clustering*. In order to obtain teh weighted gene coexpression network, the correlation matrix was transformed into adjacency matrix. Once obtain the adjacency matrix, the topological method can be used to generate the importance and distance information. However, this can not provide module information, here, author applied hierarchical clustering to form genetic tree, which implies the genealogical relation and using dynamic tree cut can further transform the tree to module information. Thus, the hierarchical clustering is vital here.
- *Module Eigengene*. Related to overall survival to generate survival-related information. The ME is developed by the first principal component of the expression matrix. And it is also good for authors also apply the Cox regression in this step, which provides solid evidences for further comparasion between Cox and DL methods.
- *Cross Validation*. K-fold cross validation is helpful when a given dataset is too small for the segmentation  of simple training/ testing/validation to produce an accurate estimate of generalization error (generated by excessively high variance), it can be used to estimate the generalization error. In this study, as the reader can tell, the probe set is around hundreds, which is not large (although we believe the dataset for gene expierement is usually large enough to omit the crosss validation), the validation is necessary.



##### Significant results and novel findings  

- Gene Coexpression Network Modules, from the training set 23 coexpression network modules are identified. Moreover, with the set cutoff value (p value), five coexpression network modules are selected. By calculating the statistic meaning and correlation bewteen gene module and representive genes, two  modules are selected with 160 genes and 880 genes form the membership respectively, and both of them involved in the common and important biological processes$^{[2]}$.

- With the constructed deep convolution neural network(input: expression value of top 10 genes from the selected two module, output: NetScore$^{[2]}$), the results show the NetScore is significantly associated with OS in the training and two test sets, especially the high risk groups.

- Cox analysis is insufficient and treat NetScore as an independent predictive factor for prognosis, which gives the result that no feature signigicantly associated with OS in test 2. However, using DL model and NetScore not only shows siginificantly associated with high-risk group in training set, but also shows a close relationship between risk group and OS in several factors like gender, age and etc. in test 2.

- DL model solve the regression problems of survival data by using a specialized loss function and has a higher predictability than Cox model in test set 1, training set and test set 2 (not reach statistic significance)$^{[2]}$.

- NetScore can be an essential predictor in early stage subgroups, which is associated with sex, smoking statusm, stage and molecular subtypes. And it presents a higher result in male, smokers, late stage and KRAS mutation samples$^{[2]}$.

  

##### Personal evaluations and prospects on this topic

**Futher Proposal**

 The motivation of this topic is worth to affirm, the data is compelling, the analysis is detailed and logical, the results are objective and meaningful for further study. However, I have some personal proposals and advice to generate a more comprehensive, derivative-oriented and convincing result.

- *Selection of Centrality of Adjacency Matrix*. When constructing weighted gene coexpression network, the authors transform the correlation matrix to adjancency matrix in order to get influential power and distance information. However, the authors do not consider the centrality but directly apply dynamic tree cut algorithm, which is workable, but it would be better to have a view of each gene's importance. And this can provide the validation of clustering.

  Adjacency matrix for N genes given an N $\times$ N matrix

$$
A_{ij} = 
\begin{cases}
1,\ if\ \ i \rightarrow j\\
0,\ otherwise
\end{cases}
$$

Then, degree will be the node importance factor after merge all the information of each storey by     topological overlap. There are rougly three methods to calculate the importance: eigenvector centrality, closeness centrality and betweenness centrality.

*Eigenvector centrality* is similar as Google PageRank algorithm, Assume the adjacency matrix A is full-rank, with eigenvalues {λi} and eigenvectors {vi}, write any vector x[0] as a linear combination of {vi}: $x[0] = \sum_i c_iv_i$, then the iterative updating$^{[1]}$:
$$
x[t] = A^tx[0] = A^t\sum_ic_iv_i = \sum_ic_iA^tv_i = \sum_ic_i\lambda^t_iv_i
$$
Hence,
$$
lim_{t \rightarrow\infty}x[t] = lim_{t \rightarrow\infty}\sum_ic_i\lambda^t_iv_i \approx c_i\lambda^t_1v_i,\ where\ \lambda_1\ is \ the\ largest\ eigenvalue
$$
Eigenvector centrality **x** = {$x_i$}, $Ax = \lambda_1x$, which means:
$$
x_i = \frac{1}{\lambda_1}\sum_jA_{ij}x_j, \forall i
$$
*Closeness centrality* Use $d_{ij}$ denotes the shortest distance (number of hops) between node i and node j. For a node i, average distance from it to all other nodes$^{[1]}$:
$$
\frac {\sum_jd_{ij}}{n-1},\ summing\ over\ all\ (i,j)\ \ pairs\ with\ j\ne i
$$
and the closeness centrality is:
$$
C_i = \frac{n-1}{\sum_jd_{ij}},\ a\ larger\ Ci\ \rightarrow\ node\ i\ is\ closer\ to\ other\ nodes\ \rightarrow\ it\ is\ more\ important
$$
*Betweenness centrality*  $g_{st}$ is the number of shortest paths between nodes s and t; $n^i_{st}$ is the number of shortest paths between nodes s and t that node i is on. Then, node i’s between centrality is:
$$
B_i = \sum_s \sum_{t<s}\frac{n^i_{st}}{g_{st}}
$$
The choice of centrality is actually essential, for different centrality evaluates different dimension of importance. Here, personally, I believe betweenness centrality is more appropriate. Since what betweenness centrality evaluates is both the importance of directly connection and the importance as a medium. As far as I am concerned, the gene works as a network, therefore, focusing on the directly connection is not enough, some genes might not be the genes has the most degree, but they may be essential cause they may play the role of the medium among the shortest path of two important genes. At that time, they are also vital.

- *Dichotomize NetScore for Risk Group*. According to authors, they choose the median value to record the NetScore for each cohort when do the survival analysis, which is definetly workable and easy to apply. However, is the median value the optimal solution for this experiment? I believe it needs further comparison, just like how people choose distance when apply the clustering: sereval distance methods are all workable, but we have preferences.

  Firstly, dataset size. The dataset is not large, which is the exact reason why the authors apply k-fold cross validation. Therefore, for a relatively small dataset, efficiency issue can be omitted, which provides us more potential methods to find the representive value.

  Secondly, variation. The variation is a key factor to consider. The cases need to be divided into two situations, when variation is small, personally I believe the average value would be more proper and accurate, since when variation is small, the average value won't be affected by extreme value and forms a union of all the data information; when variation is relatively large, median value is prefered, but it can also be optimized with biased value, for example, adding calibration constant like RMSE.

  Therefore, I believe it would be a better method to firstly set the threshold for RMSEand then calculate the RMSE for each dataset, compare the threshold with the results to determine deviation, finally choose the proper methods.

**Further Concern**

There are also some questions I can not sure for the limitation of my current knowledge, here I list and hoping professors can help me to form a better understanding.

1. Is that proper to choose to compare the DL model and Cox regression to illustrate the advantages of DL model?

   Although Cox regression is the most common menthod in multivariate analysis of survival data, it has the limitation. More specifically, although the model can analyze the censored survival time, it has certain premises$^{[3]}$, check it for the dataset of this study:

   - When observing, should try to avoid the loss of follow-up **(acquired)**

   - The sample size should not be too small **(might not acquired)**, with a certain number of deaths **(acquired)**

   - Proportional risk: the influence of a factor on survival is the same at any time, and does not change with time **(might not acquired)**

   In the paper, the authors didn't give the information about whether the gene is proportional risk, however, I am not sure since the lack of certain biology knowledge: might the gene mentioned in the paper already implied the premise.

   But, if not, then I believe whether proposing DL model advantages upon the Cox regression is valid considering the drawback might be caused by the dataset itself instead of the algorithm. It would be more convincing to construct other common-used regression model in medical like logistic regression, multiple linear regression to analyze the result.

2. I wonder is there any over-fitting or under-fitting problems in the authors CNN model? It seems to me that the authors used the k-fold cross validation, which can be a usual method to testify the problem$^{[3]}$, but they did not describe the result? Also in the paper, the model contains three round of dropout, is that aims to avoid the over-fitting problem?



##### Reference

[1] Chiang, M. (2010). *Networked life: 20 questions and answers*. Cambridge University Press. https://doi.org/10.1017/CBO9781139176200

[2] Choi, H. *A Risk Stratification Model for Lung Cancer Based on Gene Coexpression Network and Deep Learning*. Web.

[3] Ian Goodfellow, Yoshua Bengio, Aaron Courville. *Deep Learning*. MIT Press. http://www.deeplearningbook.org